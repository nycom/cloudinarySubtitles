{"version":3,"file":"cloudinary-subtitle-lib.umd.js.map","sources":["ng://cloudinary-subtitle-lib/lib/cloudinary-subtitle-lib.service.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\n\r\nexport class CloudinarySubtitleLibService {\r\n\r\n  BASE_URL = 'https://res.cloudinary.com/';\r\n  CLOUDINARY_URL_VIDEO_TYPE_EXTENSION = '/video/upload/';\r\n\r\n  constructor() {}\r\n\r\n  public addSubtitlesToVideo(cloudName: string, videoPublicId: string, subtitles: any) {\r\n\r\n    if (!cloudName || cloudName.length === 0) {\r\n      console.error(`Missing or empty appropriate cloudName...\r\n                     cloudName should be a string which represents your cloud name provided by cloudinary,\\n\r\n                     please follow the instructions and try again`);\r\n      return;\r\n    }\r\n\r\n    if (!videoPublicId || videoPublicId.length === 0) {\r\n      console.error(`Missing appropriate videoPublicId...\\n\r\n                     videoPublicId should be a string which represents the video id provided by cloudinary,\\n \r\n                     please follow the instructions and try again`);\r\n      return;\r\n    }\r\n\r\n    if (!subtitles || !subtitles.subtitles || subtitles.subtitles.length === 0) {\r\n      console.error(`Missing or bad appropriate subtitles JSON...\\n\r\n                     the appropriate subtitles JSON should be of type:\\n\r\n                     { subtitles: { 'start-timing': string, 'end-timing': string, text: string }[] }\\n\r\n                     please follow the instructions and try again`);\r\n      return;\r\n    }\r\n\r\n    let url = this.BASE_URL + cloudName + this.CLOUDINARY_URL_VIDEO_TYPE_EXTENSION;\r\n    const subtitlesArray = subtitles.subtitles;\r\n\r\n    subtitlesArray.map((entry, index) => {\r\n      if (entry['start-timing'] && entry['end-timing'] && entry.text) {\r\n          url += this.entryToCloudinaryParams(entry);\r\n      } else {\r\n        console.error(`Bad subtitle format at index ${index}, please make sure that each subtitle is of \r\n        type: { 'start-timing': string, 'end-timing': string, text: string }`);\r\n      }\r\n    });\r\n\r\n    url += videoPublicId;\r\n    return url;\r\n  }\r\n\r\n  private entryToCloudinaryParams(entry): string {\r\n    return (this.addTextPositionAndStyles(entry.text) +\r\n      this.parseTimeToParam('so_', entry['start-timing']) + ',' +\r\n      this.parseTimeToParam('eo_', entry['end-timing']) + '/');\r\n  }\r\n\r\n  private addTextPositionAndStyles(text): string {\r\n    return 'l_text:Arial_40px:' + encodeURIComponent(encodeURIComponent(text)) + ',y_60,g_south,b_black,co_white,';\r\n  }\r\n\r\n  private parseTimeToParam(prefix, time): string {\r\n    let timeArray = time.split(':'),\r\n      sec = 0, min = 1;\r\n\r\n    while (timeArray.length > 0) {\r\n      sec += min * parseFloat(timeArray.pop());\r\n      min *= 60;\r\n    }\r\n    return prefix + sec;\r\n  }\r\n}\r\n"],"names":["Injectable"],"mappings":";;;;;;;;;;AAAA;QAWE;4BAHW,6BAA6B;uDACF,gBAAgB;SAEtC;;;;;;;QAET,0DAAmB;;;;;;sBAAC,SAAiB,EAAE,aAAqB,EAAE,SAAc;;gBAEjF,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;oBACxC,OAAO,CAAC,KAAK,CAAC,4NAE8C,CAAC,CAAC;oBAC9D,OAAO;iBACR;gBAED,IAAI,CAAC,aAAa,IAAI,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE;oBAChD,OAAO,CAAC,KAAK,CAAC,2NAE8C,CAAC,CAAC;oBAC9D,OAAO;iBACR;gBAED,IAAI,CAAC,SAAS,IAAI,CAAC,SAAS,CAAC,SAAS,IAAI,SAAS,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;oBAC1E,OAAO,CAAC,KAAK,CAAC,qSAG8C,CAAC,CAAC;oBAC9D,OAAO;iBACR;;gBAED,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,GAAG,SAAS,GAAG,IAAI,CAAC,mCAAmC,CAAC;;gBAC/E,IAAM,cAAc,GAAG,SAAS,CAAC,SAAS,CAAC;gBAE3C,cAAc,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBAC9B,IAAI,KAAK,CAAC,cAAc,CAAC,IAAI,KAAK,CAAC,YAAY,CAAC,IAAI,KAAK,CAAC,IAAI,EAAE;wBAC5D,GAAG,IAAI,KAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;qBAC9C;yBAAM;wBACL,OAAO,CAAC,KAAK,CAAC,kCAAgC,KAAK,+HACkB,CAAC,CAAC;qBACxE;iBACF,CAAC,CAAC;gBAEH,GAAG,IAAI,aAAa,CAAC;gBACrB,OAAO,GAAG,CAAC;;;;;;QAGL,8DAAuB;;;;sBAAC,KAAK;gBACnC,QAAQ,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,IAAI,CAAC;oBAC/C,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,cAAc,CAAC,CAAC,GAAG,GAAG;oBACzD,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC,GAAG,GAAG,EAAE;;;;;;QAGrD,+DAAwB;;;;sBAAC,IAAI;gBACnC,OAAO,oBAAoB,GAAG,kBAAkB,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,GAAG,iCAAiC,CAAC;;;;;;;QAGzG,uDAAgB;;;;;sBAAC,MAAM,EAAE,IAAI;;gBACnC,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CACZ;;gBADnB,IACE,GAAG,GAAG,CAAC,CAAU;;gBADnB,IACW,GAAG,GAAG,CAAC,CAAC;gBAEnB,OAAO,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC3B,GAAG,IAAI,GAAG,GAAG,UAAU,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,CAAC;oBACzC,GAAG,IAAI,EAAE,CAAC;iBACX;gBACD,OAAO,MAAM,GAAG,GAAG,CAAC;;;oBArEvBA,aAAU,SAAC;wBACV,UAAU,EAAE,MAAM;qBACnB;;;;;2CAJD;;;;;;;;;;;;;;;;;;;;;;;"}
